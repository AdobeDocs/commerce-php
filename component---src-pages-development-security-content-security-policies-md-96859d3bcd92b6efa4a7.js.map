{"version":3,"file":"component---src-pages-development-security-content-security-policies-md-96859d3bcd92b6efa4a7.js","mappings":"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","sources":["webpack://commerce-php/./src/pages/development/security/content-security-policies.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/commerce-php/commerce-php/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"content-security-policies\"\n    }}>{`Content security policies`}</h1>\n    <p>{`Content Security Policies (CSP) are a powerful tool to mitigate against Cross Site Scripting (XSS)\nand related attacks, including card skimmers, session hijacking, clickjacking, and more. Web servers\nsend CSPs in response HTTP headers (namely `}<inlineCode parentName=\"p\">{`Content-Security-Policy`}</inlineCode>{` and\n`}<inlineCode parentName=\"p\">{`Content-Security-Policy-Report-Only`}</inlineCode>{`) to browsers that whitelist the origins of scripts, styles,\nand other resources. Together, CSPs and built-in browser features help prevent:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Loading a malicious script from an attacker's website`}</li>\n      <li parentName=\"ul\">{`A malicious inline script from sending credit card info to an attacker's website`}</li>\n      <li parentName=\"ul\">{`Loading a malicious style that will make users click on an element that wasn't supposed to be on a page`}</li>\n    </ul>\n    <p>{`See `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\"\n      }}>{`Content Security Policy (CSP)`}</a>{`\nand `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy\"\n      }}>{`Content-Security-Policy`}</a>{`\nto learn more about CSP and each individual policy.`}</p>\n    <h2 {...{\n      \"id\": \"application-support\"\n    }}>{`Application support`}</h2>\n    <p>{`As of version 2.3.5, Adobe Commerce and Magento Open Source support CSP headers and provides ways to configure them. (This\nfunctionality is defined in the Magento_Csp module.) The application also provides default configurations at\nthe application level and for individual core modules that require extra configuration. Policies can\nbe configured for `}<inlineCode parentName=\"p\">{`adminhtml`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`storefront`}</inlineCode>{` areas separately to accommodate different use cases.\nThe application also permits configuring unique CSPs for specific pages.`}</p>\n    <p>{`CSP can work in two modes:`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`report-only`}</inlineCode>{` - In this mode, the application reports policy violations but does not interfere. This mode is useful for debugging.  By default, CSP violations are written to the browser console, but they can be configured to be reported to an endpoint as an HTTP request to collect logs. There are a number of services that will collect, store, and sort your store's CSP violations reports for you.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`restrict mode`}</inlineCode>{` - In this mode, the application acts on any policy violations.`}</p>\n      </li>\n    </ul>\n    <h2 {...{\n      \"id\": \"default-configuration\"\n    }}>{`Default configuration`}</h2>\n    <p>{`In Adobe Commerce and Magento Open Source version 2.4.7 and later, CSP is configured in `}<inlineCode parentName=\"p\">{`restrict-mode`}</inlineCode>{` by default for payment pages in the storefront and admin areas, and in `}<inlineCode parentName=\"p\">{`report-only`}</inlineCode>{` mode for all other pages.\nThe corresponding CSP header does not contain the `}<inlineCode parentName=\"p\">{`unsafe-inline`}</inlineCode>{` keyword inside the `}<inlineCode parentName=\"p\">{`script-src`}</inlineCode>{` directive for payment pages. Also, only whitelisted inline scripts are allowed.`}</p>\n    <p>{`Prior to version 2.4.7, CSP was configured in `}<inlineCode parentName=\"p\">{`report-only`}</inlineCode>{` mode for all pages.`}</p>\n    <p>{`Once configured, the application can enforce policies like these:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Any resource, such as `}<inlineCode parentName=\"li\">{`.js`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`.css`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`.jpg`}</inlineCode>{`, or `}<inlineCode parentName=\"li\">{`.ttf`}</inlineCode>{` files, can only be loaded from the store's domain`}</li>\n      <li parentName=\"ul\">{`Iframes can only include pages from the store itself`}</li>\n      <li parentName=\"ul\">{`AJAX requests can only be sent to the store`}</li>\n      <li parentName=\"ul\">{`Forms can only be sent to the store`}</li>\n      <li parentName=\"ul\">{`Only whitelisted inline scripts and styles can be compiled by browser`}</li>\n    </ul>\n    <p>{`For more details, check the `}<inlineCode parentName=\"p\">{`Magento/Csp/etc/config.xml`}</inlineCode>{` file. Some domains have already been\nwhitelisted for modules that require it. For instance if the `}<inlineCode parentName=\"p\">{`Magento_Paypal`}</inlineCode>{` module is installed,\n`}<inlineCode parentName=\"p\">{`www.paypal.com`}</inlineCode>{` is already whitelisted for the `}<inlineCode parentName=\"p\">{`script-src`}</inlineCode>{` policy. If inline scripts and styles have also been whitelisted,\ntheir hashes will be added to the `}<inlineCode parentName=\"p\">{`Content-Security-Policy`}</inlineCode>{` header only when inline scripts/styles are not allowed.`}</p>\n    <p>{`Please note that `}<inlineCode parentName=\"p\">{`eval()`}</inlineCode>{` is still allowed.`}</p>\n    <h2 {...{\n      \"id\": \"configure-a-modules-csp-mode\"\n    }}>{`Configure a module's CSP mode`}</h2>\n    <p>{`You can set the CSP mode in a custom module by editing the module's `}<inlineCode parentName=\"p\">{`etc/config.xml`}</inlineCode>{` file. To\nset the mode to `}<inlineCode parentName=\"p\">{`restrict`}</inlineCode>{`, change the value of the `}<inlineCode parentName=\"p\">{`default/csp/mode/admin/report_only`}</inlineCode>{`\nand/or the `}<inlineCode parentName=\"p\">{`default/csp/mode/storefront/report_only`}</inlineCode>{` element to 0. To enable `}<inlineCode parentName=\"p\">{`report-only`}</inlineCode>{` mode,\nset the values to 1.`}</p>\n    <p>{`Example `}<inlineCode parentName=\"p\">{`config.xml`}</inlineCode>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<?xml version=\"1.0\"?>\n<config xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceSchemaLocation=\"urn:magento:module:Magento_Store:etc/config.xsd\">\n    <default>\n        <csp>\n            <mode>\n                <storefront>\n                    <report_only>0</report_only>\n                </storefront>\n                <admin>\n                    <report_only>0</report_only>\n                </admin>\n            </mode>\n        </csp>\n    </default>\n</config>\n`}</code></pre>\n    <p>{`You can use the `}<inlineCode parentName=\"p\">{`etc/config.xml`}</inlineCode>{` file in the `}<inlineCode parentName=\"p\">{`Magento_Csp`}</inlineCode>{` module as a reference.\n`}<a parentName=\"p\" {...{\n        \"href\": \"../build/component-file-structure.md\"\n      }}>{`Create your component file structure`}</a>{`\ndescribes how to create a module.`}</p>\n    <h2 {...{\n      \"id\": \"configure-csps-for-your-custom-codeextensiontheme\"\n    }}>{`Configure CSPs for your custom code/extension/theme`}</h2>\n    <p>{`Adobe Commerce and Magento Open Source provide multiple ways to add whitelisted resources to your custom code, extension, or theme.\nBe sure to add resources only in modules that require it. For example, adding a domain to a `}<inlineCode parentName=\"p\">{`default-src`}</inlineCode>{`\npolicy when you only need to load a `}<inlineCode parentName=\"p\">{`.js`}</inlineCode>{` file from it is not recommended. Add the domain to `}<inlineCode parentName=\"p\">{`script-src`}</inlineCode>{`\ninstead.`}</p>\n    <p>{`The following table describes each type of CSP:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Policy name`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`default-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The default policy.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`base-uri`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines which URLs can appear in a page's `}<inlineCode parentName=\"td\">{`<base>`}</inlineCode>{` element.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`child-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines the sources for workers and embedded frame contents.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`connect-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines the sources that can be loaded using script interfaces.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`font-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines which sources can serve fonts.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`form-action`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines valid endpoints for submission from `}<inlineCode parentName=\"td\">{`<form>`}</inlineCode>{` tags.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`frame-ancestors`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines the sources that can embed the current page.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`frame-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines the sources for elements such as `}<inlineCode parentName=\"td\">{`<frame>`}</inlineCode>{` and `}<inlineCode parentName=\"td\">{`<iframe>`}</inlineCode>{`.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`img-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines the sources from which images can be loaded.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`manifest-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines the allowable contents of web app manifests.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`media-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines the sources from which images can be loaded.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`object-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines the sources for the `}<inlineCode parentName=\"td\">{`<object>`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`<embed>`}</inlineCode>{`, and `}<inlineCode parentName=\"td\">{`<applet>`}</inlineCode>{` elements.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`script-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines the sources for JavaScript `}<inlineCode parentName=\"td\">{`<script>`}</inlineCode>{` elements.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`style-src`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Defines the sources for stylesheets.`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <h3 {...{\n      \"id\": \"add-a-domain-to-the-whitelist\"\n    }}>{`Add a domain to the whitelist`}</h3>\n    <p>{`You can add a domain to the whitelist for a policy (like `}<inlineCode parentName=\"p\">{`script-src`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`style-src`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`font-src`}</inlineCode>{` and others) by\nadding a `}<inlineCode parentName=\"p\">{`csp_whitelist.xml`}</inlineCode>{` to your custom module's `}<inlineCode parentName=\"p\">{`etc`}</inlineCode>{` folder.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<?xml version=\"1.0\"?>\n<csp_whitelist xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceSchemaLocation=\"urn:magento:module:Magento_Csp:etc/csp_whitelist.xsd\">\n    <policies>\n        <policy id=\"script-src\">\n            <values>\n                <value id=\"devdocs-base\" type=\"host\">https://developer.adobe.com</value>\n                <value id=\"magento\" type=\"host\">https://magento.com</value>\n            </values>\n        </policy>\n        <policy id=\"connect-src\">\n            <values>\n                <value id=\"devdocs\" type=\"host\">https://developer.adobe.com</value>\n            </values>\n        </policy>\n    </policies>\n</csp_whitelist>\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"using-csp-nonce-provider-to-allow-inline-scripts\"\n    }}>{`Using CSP nonce provider to allow inline scripts`}</h3>\n    <p>{`Adobe Commerce and Magento Open Source 2.4.7 and later include a Content Security Policy (CSP) nonce provider to facilitate the generation of unique nonce strings for each request.  These nonce strings are then attached to the CSP header.`}</p>\n    <p>{`Use the `}<inlineCode parentName=\"p\">{`generateNonce`}</inlineCode>{` function in `}<inlineCode parentName=\"p\">{`Magento\\\\Csp\\\\Helper\\\\CspNonceProvider`}</inlineCode>{` to obtain a nonce string.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`use Magento\\\\Csp\\\\Helper\\\\CspNonceProvider;\n\nclass MyClass\n{\n\n    /**\n     * @var CspNonceProvider\n     */\n    private $cspNonceProvider;\n\n    /**\n     * @param CspNonceProvider $cspNonceProvider\n     */\n    public function __construct(CspNonceProvider $cspNonceProvider)\n    {\n        $this->cspNonceProvider = $cspNonceProvider\n    }\n\n    /**\n     * Get CSP Nonce\n     *\n     * @return String\n     */\n    public function getNonce(): string\n    {\n        return $this->cspNonceProvider->generateNonce();\n    }\n}\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"whitelist-an-inline-script-or-style\"\n    }}>{`Whitelist an inline script or style`}</h3>\n    <p>{`Stores that have `}<inlineCode parentName=\"p\">{`unsafe-inline`}</inlineCode>{` disabled for `}<inlineCode parentName=\"p\">{`style-src`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`script-src`}</inlineCode>{` (default for Adobe Commerce and Magento Open Source 2.4) inline scripts and styles\nmust be whitelisted.`}</p>\n    <p>{`You must use `}<inlineCode parentName=\"p\">{`Magento\\\\Framework\\\\View\\\\Helper\\\\SecureHtmlRenderer`}</inlineCode>{`, which is available\nas a `}<inlineCode parentName=\"p\">{`$secureRenderer`}</inlineCode>{` variable in the `}<em parentName=\"p\">{`.phtml`}</em>{` templates to achieve this.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`For `}<inlineCode parentName=\"li\">{`script`}</inlineCode>{` or `}<inlineCode parentName=\"li\">{`style`}</inlineCode>{` tags containing inline JavaScript/CSS, use `}<inlineCode parentName=\"li\">{`renderTag`}</inlineCode>{`:`}</li>\n    </ul>\n    <h4 {...{\n      \"id\": \"inside-a-phtml-template\"\n    }}>{`Inside a .phtml template`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-html\"\n      }}>{`<div>Other content</div>\n<?= $secureRenderer->renderTag('script', ['type' => 'text/javascript'], \"\\\\nconsole.log('I am a whitelisted script');\\\\n\", false); ?>\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"inside-a-class-responsible-for-html-rendering_\"\n    }}>{`Inside a class responsible for HTML rendering_`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`/** @var \\\\Magento\\\\Framework\\\\View\\\\Helper\\\\SecureHtmlRenderer */\nprivate $secureRenderer;\n\n...\n\nfunction someMethod() {\n   ....\n\n   $html .= $this->secureRenderer->renderTag('style', [], \"#element { color: blue } \", false);\n\n   ....\n}\n`}</code></pre>\n    <ul>\n      <li parentName=\"ul\">{`For event handlers previously defined in HTML attributes, use `}<inlineCode parentName=\"li\">{`renderEventListenerAsTag`}</inlineCode>{`:`}</li>\n    </ul>\n    <h4 {...{\n      \"id\": \"inside-a-phtml-template-1\"\n    }}>{`Inside a .phtml template`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-html\"\n      }}>{`<!-- <div onclick=\"alert('Old way!')\">Old way</div> -->\n\n<div id=\"alert-div\">New way</div>\n<?= $secureRenderer->renderEventListenerAsTag('onclick', 'alert(\"New way!\");', '#alert-div'); ?>\n`}</code></pre>\n    <ul>\n      <li parentName=\"ul\">{`For inline styles previously defined in `}<inlineCode parentName=\"li\">{`style`}</inlineCode>{` attributes, use `}<inlineCode parentName=\"li\">{`renderStyleAsTag`}</inlineCode>{`:`}</li>\n    </ul>\n    <h4 {...{\n      \"id\": \"inside-a-phtml-template-2\"\n    }}>{`Inside a .phtml template`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-html\"\n      }}>{`<!-- <div style=\"color:blue\">Old way</div> -->\n\n<div id=\"blue-div\">New way</div>\n<?= $secureRenderer->renderStyleAsTag('color: blue', '#blue-div'); ?>\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"using-inline-scripts-and-styles-is-discouraged-in-favor-of-ui-components-and-classes\"\n    }}>{`Using inline scripts and styles is discouraged in favor of UI Components and classes`}</h4>\n    <p>{`You can also whitelist inline CSS and JS inside `}<inlineCode parentName=\"p\">{`style`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`script`}</inlineCode>{` tags in a `}<inlineCode parentName=\"p\">{`csp_whitelist.xml`}</inlineCode>{` file.\nTo do this, get a `}<inlineCode parentName=\"p\">{`sha256`}</inlineCode>{` hash of a tag's content and encode it as BASE64, then\nadd it to your module's `}<inlineCode parentName=\"p\">{`csp_whitelist.xml`}</inlineCode>{`. Programmatically, it could look like this:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`$whitelistHash = base64_encode(hash('sha256', $content, true));\n`}</code></pre>\n    <p>{`Add the corresponding policy to a `}<inlineCode parentName=\"p\">{`csp_whitelist.xml`}</inlineCode>{` file:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<?xml version=\"1.0\"?>\n<csp_whitelist xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceSchemaLocation=\"urn:magento:module:Magento_Csp:etc/csp_whitelist.xsd\">\n    <policies>\n        <policy id=\"script-src\">\n            <values>\n                <value id=\"my-scripts-hash\" type=\"hash\" algorithm=\"sha256\">B4yPHKaXnvFWtRChIbabYmUBFZdVfKKXHbWtWidDVF8=</value>\n            </values>\n        </policy>\n    </policies>\n</csp_whitelist>\n`}</code></pre>\n    <InlineAlert variant=\"warning\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`You must whitelist the content of the `}<inlineCode parentName=\"p\">{`script`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`style`}</inlineCode>{` tags that you add in the Admin. For example, the `}<strong parentName=\"p\">{`Scripts and Style Sheets`}</strong>{` field in the `}<a parentName=\"p\" {...{\n        \"href\": \"https://experienceleague.adobe.com/en/docs/commerce-admin/content-design/design/page-setup#html-head\"\n      }}>{`HTML Head`}</a>{` section.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`When `}<em parentName=\"p\">{`unsafe-inline`}</em>{` is allowed for `}<inlineCode parentName=\"p\">{`script-src`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`style-src`}</inlineCode>{` policies, whitelisted inline scripts/styles hashes\nwill not appear in the `}<inlineCode parentName=\"p\">{`Content-Security-Policy`}</inlineCode>{` header.`}</p>\n    <h3 {...{\n      \"id\": \"advanced-csp-configuration\"\n    }}>{`Advanced CSP configuration`}</h3>\n    <p>{`To configure other CSPs such as `}<inlineCode parentName=\"p\">{`sandbox`}</inlineCode>{` policy, which does not consist of whitelisted hosts\nand hashes, or for more advanced `}<inlineCode parentName=\"p\">{`fetch`}</inlineCode>{` policy configurations, like removing inline support from `}<inlineCode parentName=\"p\">{`script-src`}</inlineCode>{`,\nyou would have to create a `}<inlineCode parentName=\"p\">{`config.xml`}</inlineCode>{` file inside your custom module and rewrite the default values.\nFor reference, see `}<inlineCode parentName=\"p\">{`Magento\\\\Csp\\\\etc\\\\config.xml`}</inlineCode>{`.`}</p>\n    <h3 {...{\n      \"id\": \"report-uri-configuration\"\n    }}>{`Report-Uri configuration`}</h3>\n    <p>{`Regardless of `}<inlineCode parentName=\"p\">{`restrict`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`report-only`}</inlineCode>{` mode, CSP violations may be reported to an endpoint for collection.`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`On the `}<em parentName=\"p\">{`Admin`}</em>{` sidebar, go to `}<strong parentName=\"p\">{`Stores`}</strong>{` > `}<em parentName=\"p\">{`Settings`}</em>{` > `}<strong parentName=\"p\">{`Configuration`}</strong>{`.`}</p>\n        <p parentName=\"li\">{`If you have a multi-site installation, set the Store View control in the upper-left corner to the website where the configuration applies.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`In the left panel under `}<em parentName=\"p\">{`Security`}</em>{`, choose `}<strong parentName=\"p\">{`Content Security Policy`}</strong>{`.`}</p>\n      </li>\n    </ol>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1280px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"51.5625%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-php/static/a0ee2c37d77486de5d08693bec32d1c9/5530d/csp-report-uri.webp 320w\", \"/commerce-php/static/a0ee2c37d77486de5d08693bec32d1c9/0c8fb/csp-report-uri.webp 640w\", \"/commerce-php/static/a0ee2c37d77486de5d08693bec32d1c9/94b1e/csp-report-uri.webp 1280w\", \"/commerce-php/static/a0ee2c37d77486de5d08693bec32d1c9/677e9/csp-report-uri.webp 1787w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-php/static/a0ee2c37d77486de5d08693bec32d1c9/dd4a7/csp-report-uri.png 320w\", \"/commerce-php/static/a0ee2c37d77486de5d08693bec32d1c9/0f09e/csp-report-uri.png 640w\", \"/commerce-php/static/a0ee2c37d77486de5d08693bec32d1c9/bbbf7/csp-report-uri.png 1280w\", \"/commerce-php/static/a0ee2c37d77486de5d08693bec32d1c9/937f1/csp-report-uri.png 1787w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/commerce-php/static/a0ee2c37d77486de5d08693bec32d1c9/bbbf7/csp-report-uri.png\",\n            \"alt\": \"csp report uri\",\n            \"title\": \"csp report uri\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`The Create Order page in the Admin and the Checkout page in the storefront can be configured to have their own URI. However, if these fields are left blank, the default URI for the admin and storefront areas is used for reporting.`}</p>\n    <p>{`The URL to use for reporting by browsers can also be configured programmatically in the `}<inlineCode parentName=\"p\">{`config.xml`}</inlineCode>{` for your custom module:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<?xml version=\"1.0\"?>\n<config xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceSchemaLocation=\"urn:magento:module:Magento_Store:etc/config.xsd\">\n    <default>\n        <csp>\n            <mode>\n                <storefront>\n                    <report_uri>http://csp-reporting-service.com/my-project/endpoint</report_uri>\n                </storefront>\n                <admin>\n                    <report_uri>http://csp-reporting-service.com/my-project/endpoint</report_uri>\n                </admin>\n            </mode>\n        </csp>\n    </default>\n</config>\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"page-specific-content-security-policies\"\n    }}>{`Page specific Content-Security-Policies`}</h3>\n    <p>{`Adobe Commerce and Magento Open Source can send unique policies for a specific page.\nFor example, to configure policies for the Checkout page in the storefront, add the following to the `}<inlineCode parentName=\"p\">{`config.xml`}</inlineCode>{` file for your custom module:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<?xml version=\"1.0\"?>\n<config xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceSchemaLocation=\"urn:magento:module:Magento_Store:etc/config.xsd\">\n    <default>\n       <csp>\n          <mode>\n             <storefront_checkout_index_index>\n                <report_only>0</report_only>\n             </storefront_checkout_index_index>\n          </mode>\n          <policies>\n             <storefront_checkout_index_index>\n                <scripts>\n                   <inline>0</inline>\n                   <event_handlers>1</event_handlers>\n                </scripts>\n             </storefront_checkout_index_index>\n          </policies>\n       </csp>\n    </default>\n</config>\n`}</code></pre>\n    <p>{`Alternatively, you can implement `}<inlineCode parentName=\"p\">{`Magento\\\\Csp\\\\Api\\\\CspAwareActionInterface`}</inlineCode>{`\nin a controller responsible for the page and define the `}<inlineCode parentName=\"p\">{`modifyCsp`}</inlineCode>{` method. It receives existing CSPs\nread from configs and allows you redefine them by returning a new list. See the example below:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`class Mypage extends \\\\Magento\\\\Framework\\\\App\\\\Action\\\\Action implements \\\\Magento\\\\Csp\\\\Api\\\\CspAwareActionInterface\n{\n    /**\n     * My custom page.\n     *\n     * @inheritDoc\n     */\n    public function execute()\n    {\n        return $this->resultPageFactory->create();\n    }\n\n    public function modifyCsp(array $appliedPolicies): array\n    {\n        $appliedPolicies[] = new \\\\Magento\\\\Csp\\\\Model\\\\Policy\\\\FetchPolicy(\n            'form-action',\n            false,\n            ['https://my-site.com'],\n            ['https']\n        );\n\n        return $appliedPolicies;\n    }\n}\n`}</code></pre>\n    <p>{`You do not need to define other policy options in contexts like `}<em parentName=\"p\">{`unsafe-inline`}</em>{`. The same\npolicy options read from config will be merged later.`}</p>\n    <h3 {...{\n      \"id\": \"troubleshooting\"\n    }}>{`Troubleshooting`}</h3>\n    <p>{`Users might sometimes see browser errors due to certain scripts being blocked because of CSP:`}</p>\n    <p><inlineCode parentName=\"p\">{`Refused to execute inline script because it violates the following Content Security Policy directive: \"script-src`}</inlineCode></p>\n    <p>{`To fix this issue, `}<a parentName=\"p\" {...{\n        \"href\": \"#whitelist-an-inline-script-or-style\"\n      }}>{`whitelist`}</a>{` the blocked scripts using the `}<inlineCode parentName=\"p\">{`SecureHtmlRenderer`}</inlineCode>{` class or use the `}<a parentName=\"p\" {...{\n        \"href\": \"#using-csp-nonce-provider-to-allow-inline-scripts\"\n      }}>{`CSPNonceProvider`}</a>{` class to allow scripts to be executed.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","InlineAlert","name","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","variant","slots","isMDXComponent"],"sourceRoot":""}