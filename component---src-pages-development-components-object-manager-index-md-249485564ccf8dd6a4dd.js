"use strict";(self.webpackChunkcommerce_php=self.webpackChunkcommerce_php||[]).push([[2018],{2818:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return l},default:function(){return u}});var a,o=n(87462),i=n(63366),r=(n(15007),n(64983)),s=n(91515),c=["components"],l={},d=(a="InlineAlert",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.mdx)("div",e)}),m={_frontmatter:l},p=s.Z;function u(e){var t=e.components,n=(0,i.Z)(e,c);return(0,r.mdx)(p,(0,o.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"object-manager"},"Object manager"),(0,r.mdx)("p",null,"Large applications, such as the Adobe Commerce and Magento Open Source applications, use an object manager to avoid boilerplate code when composing objects during instantiation."),(0,r.mdx)("p",null,"In Adobe Commerce and Magento Open Source, the implementation of the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/magento/magento2/blob/2.4/lib/internal/Magento/Framework/ObjectManagerInterface.php"},(0,r.mdx)("inlineCode",{parentName:"a"},"ObjectManagerInterface"))," performs the duties of an object manager."),(0,r.mdx)(d,{variant:"warning",slots:"text",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,"The application prohibits the direct use of the ",(0,r.mdx)("inlineCode",{parentName:"p"},"ObjectManager")," in your code because it hides the real dependencies of a class.\nSee ",(0,r.mdx)("a",{parentName:"p",href:"#usage-rules"},"usage rules"),"."),(0,r.mdx)("h2",{id:"responsibilities"},"Responsibilities"),(0,r.mdx)("p",null,"The object manager has the following responsibilities:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"Object creation in factories and proxies"),(0,r.mdx)("li",{parentName:"ul"},"Implementing the singleton pattern by returning the same shared instance of a class when requested"),(0,r.mdx)("li",{parentName:"ul"},"Dependency management by instantiating the preferred class when a constructor requests its interface"),(0,r.mdx)("li",{parentName:"ul"},"Automatically instantiating parameters in class constructors")),(0,r.mdx)("h2",{id:"configuration"},"Configuration"),(0,r.mdx)("p",null,"The ",(0,r.mdx)("a",{parentName:"p",href:"../../build/dependency-injection-file.md"},(0,r.mdx)("inlineCode",{parentName:"a"},"di.xml"))," file configures the object manager and tells it how to handle ",(0,r.mdx)("a",{parentName:"p",href:"../dependency-injection.md"},"dependency injection"),"."),(0,r.mdx)("p",null,"This file specifies the preferred implementation class the object manager generates for the interface declared in a class constructor.\nThe file also specifies whether the object manager should create an object for every request or treat the object as a singleton."),(0,r.mdx)("h2",{id:"usage-rules"},"Usage rules"),(0,r.mdx)("p",null,"Adobe Commerce and Magento Open Source use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"ObjectManager")," to generate and inject the classes declared in your constructor.\nClasses should not ask for the ",(0,r.mdx)("inlineCode",{parentName:"p"},"ObjectManager")," itself as a constructor dependency."),(0,r.mdx)("p",null,"You do not call the object manager directly because the framework handles this automatically.\nDirect use of the ",(0,r.mdx)("inlineCode",{parentName:"p"},"create")," function prevents type validation and type hinting that a ",(0,r.mdx)("a",{parentName:"p",href:"../factories.md"},"factory")," class provides."),(0,r.mdx)("p",null,"Object creation is also a separate responsibility that should be moved to a dedicated class such as a ",(0,r.mdx)("a",{parentName:"p",href:"../factories.md"},"factory")," or ",(0,r.mdx)("a",{parentName:"p",href:"../proxies.md"},"proxy"),".\nIn most cases, the framework generates these classes automatically during code compilation."),(0,r.mdx)(d,{variant:"warning",slots:"text",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,"You may notice in the Adobe Commerce and Magento Open Source codebase that some core classes still call the ",(0,r.mdx)("inlineCode",{parentName:"p"},"ObjectManager")," directly.\nThis code needs porting or exist for backward compatibility purposes.\nThey are not tacit endorsements of using the ",(0,r.mdx)("inlineCode",{parentName:"p"},"ObjectManager")," directly."),(0,r.mdx)("h3",{id:"exceptions"},"Exceptions"),(0,r.mdx)("p",null,"You can depend on and use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"ObjectManager")," class in the following scenarios:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"You can use the object manager in static magic methods like ",(0,r.mdx)("inlineCode",{parentName:"li"},"__wakeup()"),", ",(0,r.mdx)("inlineCode",{parentName:"li"},"__sleep()"),", etc.",(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},"An example can be found in the ",(0,r.mdx)("inlineCode",{parentName:"li"},"__wakeup()")," method in the ",(0,r.mdx)("a",{parentName:"li",href:"https://github.com/magento/magento2/blob/2.4/app/code/Magento/Eav/Model/Entity/Attribute/AbstractAttribute.php"},(0,r.mdx)("inlineCode",{parentName:"a"},"Magento/Eav/Model/Entity/Attribute/AbstractAttribute"))," class."))),(0,r.mdx)("li",{parentName:"ul"},"You can use the ",(0,r.mdx)("inlineCode",{parentName:"li"},"ObjectManager")," to maintain backward compatibility for a constructor."),(0,r.mdx)("li",{parentName:"ul"},"In a global scope, like in fixtures of integration tests, you can use the object manager."),(0,r.mdx)("li",{parentName:"ul"},"The object manager can be a dependency in classes used for creating objects such as factories or proxies.")),(0,r.mdx)("h3",{id:"programmatic-product-updates"},"Programmatic product updates"),(0,r.mdx)("p",null,"If the Access Control List (ACL) rules contain incorrect settings, scripts that update products will fail validation.\nThis results in products assigned to the wrong store view with the wrong status."),(0,r.mdx)("p",null,"To skip ACL validations, use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"ObjectManager")," to set a dynamic dependency injection preference for ",(0,r.mdx)("inlineCode",{parentName:"p"},"Magento\\Framework\\Authorization\\PolicyInterface"),"."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-php"},"$objectManager = $bootstrap->getObjectManager();\n$objectManager->configure([\n    'preferences' => [\n        'Magento\\Framework\\Authorization\\PolicyInterface' => 'Magento\\Framework\\Authorization\\Policy\\DefaultPolicy'\n    ]\n]);\n")))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-development-components-object-manager-index-md-249485564ccf8dd6a4dd.js.map