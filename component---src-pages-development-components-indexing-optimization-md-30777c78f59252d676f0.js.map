{"version":3,"file":"component---src-pages-development-components-indexing-optimization-md-30777c78f59252d676f0.js","mappings":"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","sources":["webpack://commerce-php/./src/pages/development/components/indexing/optimization.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/commerce-php/commerce-php/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"indexer-optimization\"\n    }}>{`Indexer optimization`}</h1>\n    <p>{`Use batching and table switching to optimize the performance of indexers.`}</p>\n    <h2 {...{\n      \"id\": \"indexer-batching\"\n    }}>{`Indexer batching`}</h2>\n    <p>{`Adobe Commerce and Magento Open Source can increase the memory for processing a large amount of data by using memory engines instead of InnoDB. The algorithm increases the memory value for the `}<inlineCode parentName=\"p\">{`max_heap_table_size`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`tmp_table_size`}</inlineCode>{` MySQL parameters.`}</p>\n    <p>{`The interface `}<inlineCode parentName=\"p\">{`BatchSizeManagementInterface`}</inlineCode>{` provides the ability to set the MEMORY table size for indexer processes according to batch size and index row size.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`namespace Magento\\\\Framework\\\\Indexer;\n\nuse Magento\\\\Framework\\\\DB\\\\Adapter\\\\AdapterInterface;\n\n/**\n * Batch size manager can be used to ensure that MEMORY table has enough memory for data in batch.\n * @api\n */\ninterface BatchSizeManagementInterface\n{\n    /**\n     * Ensure memory size for data in batch.\n     *\n     * @param AdapterInterface $adapter database adapter.\n     * @param int $batchSize\n     * @return void\n     */\n    public function ensureBatchSize(\\\\Magento\\\\Framework\\\\DB\\\\Adapter\\\\AdapterInterface $adapter, $batchSize);\n}\n`}</code></pre>\n    <p>{`The interface `}<inlineCode parentName=\"p\">{`IndexTableRowSizeEstimatorInterface`}</inlineCode>{` calculates the memory size for all rows per `}<a parentName=\"p\" {...{\n        \"href\": \"https://glossary.magento.com/entity\"\n      }}>{`entity`}</a>{` in the index table. The entity can store several rows in an index table generated by different store dimensions, such as count of websites and customer groups.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`namespace Magento\\\\Framework\\\\Indexer;\n\n/**\n * Calculate memory size for entity according different dimensions.\n * @api\n */\ninterface IndexTableRowSizeEstimatorInterface\n{\n    /**\n     * Calculate memory size for entity row.\n     *\n     * @return float\n     */\n    public function estimateRowSize();\n}\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"exceeding-allocated-memory-size\"\n    }}>{`Exceeding allocated memory size`}</h3>\n    <p>{`When the allocated memory size for a temporary table will be greater than 20% of `}<inlineCode parentName=\"p\">{`innodb_buffer_pool_size`}</inlineCode>{`, the following message is written to the log.`}</p>\n    <p><inlineCode parentName=\"p\">{`Memory size allocated for the temporary table is more than 20% of innodb_buffer_pool_size.`}</inlineCode></p>\n    <p>{`To prevent this error message, update `}<inlineCode parentName=\"p\">{`innodb_buffer_pool_size`}</inlineCode>{` or decrease the batch size value (which decreases memory usage for the temporary table).`}</p>\n    <h2 {...{\n      \"id\": \"batching-configuration\"\n    }}>{`Batching configuration`}</h2>\n    <p>{`Batching is available for the following indexers:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Index name`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Configured object`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Parameter name`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Default value`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`catalog_product_price (Product Price)`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Magento\\\\Catalog\\\\Model\\\\`}<br />{`ResourceModel\\\\Product\\\\Indexer\\\\Price\\\\BatchSizeCalculator`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`batchRowsCount`}{`['default']`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`5000`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`cataloginventory_stock (Stock)`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Magento\\\\CatalogInventory\\\\Model\\\\`}<br />{`Indexer\\\\Stock\\\\Action\\\\Full`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`batchRowsCount`}{`['default']`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`200`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`catalog_category_product (Category Products)`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Magento\\\\Catalog\\\\Model\\\\`}<br />{`Indexer\\\\Category\\\\Product\\\\Action\\\\Full`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`batchRowsCount`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`100000`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`catalog_product_attribute (Product Attribute)`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Magento\\\\Catalog\\\\Model\\\\`}<br />{`ResourceModel\\\\Product\\\\Indexer\\\\Eav\\\\BatchSizeCalculator`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`batchSizes`}{`['decimal']`}{`, batchSizes`}{`['source']`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`1000, 1000`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`Changing the batch size can help you optimize indexer running time. For example, for a store with the following characteristics:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`10 websites`}</li>\n      <li parentName=\"ul\">{`10 store groups`}</li>\n      <li parentName=\"ul\">{`20 store views`}</li>\n      <li parentName=\"ul\">{`300 tier prices`}</li>\n      <li parentName=\"ul\">{`About 40,000 products (of which 254 are configurable)`}</li>\n    </ul>\n    <p>{`Reducing the batch size for `}<inlineCode parentName=\"p\">{`catalog_product_price`}</inlineCode>{` indexer from 5000 to 1000 decreases the execution time from about 4 hours to less than 2 hours. You can experiment to determine the ideal batch size. In general, halving the batch size can decrease the indexer execution time.`}</p>\n    <p>{`The following examples illustrate how to define a custom batch size for configurable products. Add these samples to your  `}<inlineCode parentName=\"p\">{`{Your_Module_Name}/etc/di.xml`}</inlineCode>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`....\n<type name=\"Magento\\\\Catalog\\\\Model\\\\ResourceModel\\\\Product\\\\Indexer\\\\Price\\\\BatchSizeCalculator\">\n    <arguments>\n        <argument name=\"batchRowsCount\" xsi:type=\"array\">\n            <item name=\"configurable\" xsi:type=\"number\">5000</item>\n        </argument>\n    </arguments>\n</type>\n...\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<type name=\"Magento\\\\CatalogInventory\\\\Model\\\\Indexer\\\\Stock\\\\Action\\\\Full\">\n    <arguments>\n        <argument name=\"batchRowsCount\" xsi:type=\"array\">\n            <item name=\"configurable\" xsi:type=\"number\">200</item>\n        </argument>\n    </arguments>\n</type>\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"setting-batch-size-with-environment-variables\"\n    }}>{`Setting batch size with environment variables`}</h3>\n    <p>{`As of Adobe Commerce and Magento Open Source 2.4.3, it is possible to configure the batch size with environment variables, or in `}<inlineCode parentName=\"p\">{`app/etc/env.php`}</inlineCode>{`, for the following indexers:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`cataloginventory_stock`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`catalog_category_product`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`catalogsearch_fulltext`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`catalog_product_price`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`catalogpermissions_category`}</inlineCode></li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`inventory`}</inlineCode></li>\n    </ul>\n    <p>{`Here is an example of the configuration in `}<inlineCode parentName=\"p\">{`app/etc/env.php`}</inlineCode></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`<?php\nreturn [\n    'indexer' => [\n        'batch_size' => [\n            'cataloginventory_stock' => [\n                'simple' => 200\n            ],\n            'catalog_category_product' => 666,\n            'catalogsearch_fulltext' => [\n                'partial_reindex' => 100,\n                'mysql_get' => 500,\n                'elastic_save' => 500\n            ],\n            'catalog_product_price' => [\n                'simple' => 200,\n                'default' => 500,\n                'configurable' => 666\n            ],\n            'catalogpermissions_category' => 999,\n            'inventory' => [\n                'simple' => 210,\n                'default' => 510,\n                'configurable' => 616\n            ]\n        ]\n    ]\n];\n`}</code></pre>\n    <p>{`The batches size for `}<inlineCode parentName=\"p\">{`catalog_category_product`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`catalogpermissions_category`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`catalogpermissions_category`}</inlineCode>{` will be set for all product types.`}</p>\n    <p>{`Batch size for `}<inlineCode parentName=\"p\">{`catalogsearch_fulltext`}</inlineCode>{` can be set using different parameters.`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`partial_reindex`}</inlineCode>{` - represents how many products will be processed in a partial reindex.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`elastic_save`}</inlineCode>{` - represents how many products will be saved as a batch into Elasticsearch.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`mysql_get`}</inlineCode>{` - represents how many searchable products will be retrieved from Mysql.`}</li>\n    </ul>\n    <p>{`Batch size for `}<inlineCode parentName=\"p\">{`cataloginventory_stock`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`catalog_product_price`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`inventory`}</inlineCode>{` can be set up for each product type. If no batch size is set for a specific product type, the `}<inlineCode parentName=\"p\">{`default`}</inlineCode>{` value is used. We recommend setting the `}<inlineCode parentName=\"p\">{`default`}</inlineCode>{` value for each indexer to allow for different batch sizes per product type.`}</p>\n    <h2 {...{\n      \"id\": \"indexer-table-switching\"\n    }}>{`Indexer table switching`}</h2>\n    <p>{`Adobe Commerce and Magento Open Source optimize certain indexer processes to prevent deadlocks and wait locks caused by read/write collisions on the same table. In these cases, the application uses separate tables for performing read operations and reindexing. As a result of this table switching process, customers are not impacted when you run a full reindex. For example, when `}<inlineCode parentName=\"p\">{`catalog_product_price`}</inlineCode>{` is reindexing, customers won't be slowed down as they navigate on Categories pages, search products, or user layer navigation filters with price filters.`}</p>\n    <p>{`The application uses the following tables to support table switching.`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Indexer name`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Tables used`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}></th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`catalog_product_price`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`catalog_product_index_price`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`catalog_product_index_price_replica`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`cataloginventory_stock`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`cataloginventory_stock_status`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`cataloginventory_stock_status_replica`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`catalog_category_product`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`catalog_category_product_index`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`catalog_category_product_index_replica`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`catalog_product_attribute`}</inlineCode>{` (select, multiselect attributes)`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`catalog_product_index_eav`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`catalog_product_index_eav_replica`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`catalog_product_attribute`}</inlineCode>{` (decimal values)`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`catalog_product_index_eav_decimal`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`catalog_product_index_eav_decimal_replica`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`catalogrule_rule`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`catalogrule_product`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`catalogrule_product_replica`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`catalogrule_product_price`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`catalogrule_product_price_replica`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`catalogrule_group_website`}</inlineCode>{`, `}<inlineCode parentName=\"td\">{`catalogrule_group_website_replica`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}></td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`Make sure that these indexers are in \"Update By Schedule\" mode. If \"Update On Save\" mode is selected, some data can be lost if you make changes during full reindex.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`The indexer table switching mechanism requires additional database storage.`}</p>\n    <h3 {...{\n      \"id\": \"eav-indexer-optimization\"\n    }}>{`EAV indexer optimization`}</h3>\n    <p>{`The Product EAV indexer reorganizes the EAV product structure to a flat structure.\nAs of Adobe Commerce and Magento Open Source 2.3, under certain circumstances, you can disable this indexer to improve performance. (Its indexation takes about 5 minutes on a large Commerce performance profile.)`}</p>\n    <p>{`You cannot disable the Product EAV indexer if you have installed any 3rd-party extensions that rely on the Product EAV indexer.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`To determine whether any 3rd-party extensions are using the Product EAV indexer, check the `}<inlineCode parentName=\"p\">{`catalog_product_index_eav`}</inlineCode>{` table for reading/writing activity.`}</p>\n    <p>{`To disable the Product EAV indexer in the Admin, go to `}<strong parentName=\"p\">{`Stores`}</strong>{` > Settings > `}<strong parentName=\"p\">{`Configuration`}</strong>{` > `}<strong parentName=\"p\">{`Catalog`}</strong>{` > `}<strong parentName=\"p\">{`Catalog`}</strong>{` > `}<strong parentName=\"p\">{`Catalog Search`}</strong>{` and set the value of `}<strong parentName=\"p\">{`Enable EAV Indexer`}</strong>{` to No.`}</p>\n    <h2 {...{\n      \"id\": \"customer-group-limitations-by-websites\"\n    }}>{`Customer group limitations by websites`}</h2>\n    <p>{`By default, all websites are assigned to a customer group. If there are a large number of products, websites, customer groups, and B2B shared catalogs, the execution time of the `}<inlineCode parentName=\"p\">{`Product Price`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`Catalog Rule`}</inlineCode>{` indexers may be quite long. This is because each website, customer group, shared catalog, and product SKU must all be indexed against each other in the product price and catalog rule indexer-related tables.`}</p>\n    <p>{`You can exclude websites from a customer group or shared catalog on the `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.magento.com/user-guide/customers/customer-groups.html#create-a-customer-group\"\n      }}>{`Customer Groups page`}</a>{`. Excluding websites can decrease `}<inlineCode parentName=\"p\">{`Product Price`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`Catalog Rule`}</inlineCode>{` indexing time, because excluded websites are not indexed.`}</p>\n    <p>{`When a customer group with a new, excluded website is saved, the `}<inlineCode parentName=\"p\">{`Product Price`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`Catalog Rule`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`Catalog Search`}</inlineCode>{` indexes are invalidated. If you have a large number of products, websites, and customer groups, we recommended you pause the reindex process until you have excluded websites from the customer groups.`}</p>\n    <p>{`You cannot exclude websites from a shared catalog on a shared catalog create/edit page. However, you can exclude websites from a customer group that is created from a shared catalog.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`By default, no websites are excluded from a customer group or shared catalog.\nYou cannot exclude websites from the `}<inlineCode parentName=\"p\">{`NOT LOGGED IN`}</inlineCode>{` customer group.`}</p>\n    <InlineAlert variant=\"warning\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`When a website is added to the excluded customer group and a customer who belongs to this group is trying to login to their account on the excluded website, the customer gets the `}<inlineCode parentName=\"p\">{`\"This website is excluded from customer's group.\"`}</inlineCode>{` warning.\nCustomers are not allowed to login to the website even if `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.magento.com/user-guide/customers/account-scope.html\"\n      }}>{`the scope of customer accounts is shared with all websites`}</a>{`, because there are no prices in the index table for this user.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["name","_frontmatter","InlineAlert","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","variant","slots","isMDXComponent"],"sourceRoot":""}