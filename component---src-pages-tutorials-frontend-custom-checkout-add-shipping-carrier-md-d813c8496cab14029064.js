"use strict";(self.webpackChunkcommerce_php=self.webpackChunkcommerce_php||[]).push([[45834],{1103:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return d},default:function(){return m}});var n=a(87462),o=a(45987),r=(a(35776),a(3905)),i=a(91515);const s=["components"],d={},p={_frontmatter:d},c=i.Z;function m(e){let{components:t}=e,a=(0,o.Z)(e,s);return(0,r.mdx)(c,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"add-a-custom-shipping-carrier"},"Add a custom shipping carrier"),(0,r.mdx)("p",null,"This topic describes how to add a custom shipping carrier."),(0,r.mdx)("p",null,"To add a new shipping carrier to the checkout:"),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("a",{parentName:"li",href:"#step-1-create-a-new-module"},"Create a new module")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("a",{parentName:"li",href:"#step-2-add-the-module-configuration"},"Add the carrier configuration")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("a",{parentName:"li",href:"#step-3-create-the-carrier-model"},"Create the carrier model")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("a",{parentName:"li",href:"#step-4-enable-the-module"},"Enable the module"))),(0,r.mdx)("h2",{id:"step-1-create-a-new-module"},"Step 1: Create a new module"),(0,r.mdx)("p",null,"The example module for use here is ",(0,r.mdx)("inlineCode",{parentName:"p"},"Vendor_CustomShipping"),"."),(0,r.mdx)("h3",{id:"source-code-of-appcodevendorcustomshippingregistrationphp"},"Source code of ",(0,r.mdx)("inlineCode",{parentName:"h3"},"app/code/Vendor/CustomShipping/registration.php")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-php"},"<?php\n\ndeclare(strict_types=1);\n\nuse Magento\\Framework\\Component\\ComponentRegistrar;\n\nComponentRegistrar::register(\n    ComponentRegistrar::MODULE,\n    'Vendor_CustomShipping',\n    __DIR__\n);\n\n")),(0,r.mdx)("h3",{id:"source-code-of-appcodevendorcustomshippingcomposerjson"},"Source code of ",(0,r.mdx)("inlineCode",{parentName:"h3"},"app/code/Vendor/CustomShipping/composer.json")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "name": "vendor/module-custom-shipping",\n    "description": "Custom shipping module",\n    "require": {\n        "php": "~7.4.0||~8.1.0",\n        "magento/framework": "102.0.*",\n        "magento/module-backend": "101.0.*",\n        "magento/module-catalog": "103.0.*",\n        "magento/module-config": "101.1.*",\n        "magento/module-directory": "100.3.*",\n        "magento/module-quote": "101.1.*",\n        "magento/module-sales": "102.0.*",\n        "magento/module-sales-rule": "101.1.*",\n        "magento/module-shipping": "100.3.*",\n        "magento/module-store": "101.0.*"\n    },\n    "type": "magento2-module",\n    "license": [\n        "OSL-3.0",\n        "AFL-3.0"\n    ],\n    "autoload": {\n        "files": [\n            "registration.php"\n        ],\n        "psr-4": {\n            "Vendor\\\\CustomShipping\\\\": ""\n        }\n    }\n}\n')),(0,r.mdx)("h3",{id:"source-code-of-appcodevendorcustomshippingetcmodulexml"},"Source code of ",(0,r.mdx)("inlineCode",{parentName:"h3"},"app/code/Vendor/CustomShipping/etc/module.xml")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0"?>\n<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n        xsi:noNamespaceSchemaLocation="urn:magento:framework:Module/etc/module.xsd">\n    <module name="Vendor_CustomShipping"/>\n</config>\n')),(0,r.mdx)("h2",{id:"step-2-add-the-module-configuration"},"Step 2: Add the module configuration"),(0,r.mdx)("p",null,"To add a module configuration use the following source code snippets."),(0,r.mdx)("h3",{id:"source-code-of-appcodevendorcustomshippingetcadminhtmlsystemxml"},"Source code of ",(0,r.mdx)("inlineCode",{parentName:"h3"},"app/code/Vendor/CustomShipping/etc/adminhtml/system.xml")),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"system.xml")," source code declares custom shipping module options:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"Enabled"),(0,r.mdx)("li",{parentName:"ul"},"Title"),(0,r.mdx)("li",{parentName:"ul"},"Method Name"),(0,r.mdx)("li",{parentName:"ul"},"Shipping Cost"),(0,r.mdx)("li",{parentName:"ul"},"Ship to Applicable Countries"),(0,r.mdx)("li",{parentName:"ul"},"Ship to Specific Countries"),(0,r.mdx)("li",{parentName:"ul"},"Show Method if Not Applicable"),(0,r.mdx)("li",{parentName:"ul"},"Sort Order")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0"?>\n<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n        xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Config:etc/system_file.xsd">\n    <system>\n        <section id="carriers">\n            <group id="customshipping" translate="label" type="text" sortOrder="0" showInDefault="1" showInWebsite="1" showInStore="1">\n                <label>Custom Shipping Module</label>\n                <field id="active" translate="label" type="select" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1" canRestore="1">\n                    <label>Enabled</label>\n                    <source_model>Magento\\Config\\Model\\Config\\Source\\Yesno</source_model>\n                </field>\n                <field id="title" translate="label" type="text" sortOrder="20" showInDefault="1" showInWebsite="1" showInStore="1" canRestore="1">\n                    <label>Title</label>\n                </field>\n                <field id="name" translate="label" type="text" sortOrder="30" showInDefault="1" showInWebsite="1" showInStore="1" canRestore="1">\n                    <label>Method Name</label>\n                </field>\n                <field id="shipping_cost" translate="label" type="text" sortOrder="40" showInDefault="1" showInWebsite="1" showInStore="1" canRestore="1">\n                    <label>Shipping Cost</label>\n                    <validate>validate-number validate-zero-or-greater</validate>\n                </field>\n                <field id="sallowspecific" translate="label" type="select" sortOrder="50" showInDefault="1" showInWebsite="1" showInStore="1" canRestore="1">\n                    <label>Ship to Applicable Countries</label>\n                    <frontend_class>shipping-applicable-country</frontend_class>\n                    <source_model>Magento\\Shipping\\Model\\Config\\Source\\Allspecificcountries</source_model>\n                </field>\n                <field id="specificcountry" translate="label" type="multiselect" sortOrder="60" showInDefault="1" showInWebsite="1" showInStore="1" canRestore="1">\n                    <label>Ship to Specific Countries</label>\n                    <source_model>Magento\\Directory\\Model\\Config\\Source\\Country</source_model>\n                    <can_be_empty>1</can_be_empty>\n                </field>\n                <field id="showmethod" translate="label" type="select" sortOrder="70" showInDefault="1" showInWebsite="1" showInStore="1">\n                    <label>Show Method if not applicable</label>\n                    <source_model>Magento\\Config\\Model\\Config\\Source\\Yesno</source_model>\n                    <frontend_class>shipping-skip-hide</frontend_class>\n                </field>\n                <field id="sort_order" translate="label" type="text" sortOrder="80" showInDefault="1" showInWebsite="1" showInStore="1" canRestore="1">\n                    <label>Sort Order</label>\n                </field>\n            </group>\n        </section>\n    </system>\n</config>\n')),(0,r.mdx)("h3",{id:"source-code-of-appcodevendorcustomshippingetcconfigxml"},"Source code of ",(0,r.mdx)("inlineCode",{parentName:"h3"},"app/code/Vendor/CustomShipping/etc/config.xml")),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"config.xml")," file specifies default values for custom shipping module options and the shipping module model, ",(0,r.mdx)("inlineCode",{parentName:"p"},"Vendor\\CustomShipping\\Model\\Carrier\\Customshipping"),":"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0"?>\n<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n        xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Store:etc/config.xsd">\n    <default>\n        <carriers>\n            <customshipping>\n                <active>0</active>\n                <title>Custom Shipping Title</title>\n                <name>Custom Shipping Method Name</name>\n                <shipping_cost>10</shipping_cost>\n                <sallowspecific>0</sallowspecific>\n                <sort_order>15</sort_order>\n                <model>Vendor\\CustomShipping\\Model\\Carrier\\Customshipping</model>\n            </customshipping>\n        </carriers>\n    </default>\n</config>\n')),(0,r.mdx)("h2",{id:"step-3-create-the-carrier-model"},"Step 3: Create the carrier model"),(0,r.mdx)("p",null,"In this example, the ",(0,r.mdx)("inlineCode",{parentName:"p"},"Vendor\\CustomShipping\\Model\\Carrier\\Customshipping")," class is a skeleton of a carrier model. You can extend it to fit your needs."),(0,r.mdx)("p",null,"The carrier class implements the ",(0,r.mdx)("inlineCode",{parentName:"p"},"CarrierInterface")," interface and retrieves all available shipping methods in the ",(0,r.mdx)("inlineCode",{parentName:"p"},"getAllowedMethods")," function. The ",(0,r.mdx)("inlineCode",{parentName:"p"},"collectRates")," function returns the ",(0,r.mdx)("inlineCode",{parentName:"p"},"\\Magento\\Shipping\\Model\\Rate\\Result")," object if the carrier method is available on checkout. Otherwise, it returns ",(0,r.mdx)("inlineCode",{parentName:"p"},"false"),"---the carrier method is not applicable to the shopping cart."),(0,r.mdx)("h3",{id:"source-code-of-appcodevendorcustomshippingmodelcarriercustomshippingphp"},"Source code of ",(0,r.mdx)("inlineCode",{parentName:"h3"},"app/code/Vendor/CustomShipping/Model/Carrier/Customshipping.php")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-php"},"<?php\n\ndeclare(strict_types=1);\n\nnamespace Vendor\\CustomShipping\\Model\\Carrier;\n\nuse Magento\\Framework\\App\\Config\\ScopeConfigInterface;\nuse Magento\\Quote\\Model\\Quote\\Address\\RateRequest;\nuse Magento\\Quote\\Model\\Quote\\Address\\RateResult\\Method;\nuse Magento\\Quote\\Model\\Quote\\Address\\RateResult\\MethodFactory;\nuse Magento\\Quote\\Model\\Quote\\Address\\RateResult\\ErrorFactory;\nuse Magento\\Shipping\\Model\\Carrier\\AbstractCarrier;\nuse Magento\\Shipping\\Model\\Carrier\\CarrierInterface;\nuse Magento\\Shipping\\Model\\Rate\\Result;\nuse Magento\\Shipping\\Model\\Rate\\ResultFactory;\nuse Psr\\Log\\LoggerInterface;\n\nclass Customshipping extends AbstractCarrier implements CarrierInterface\n{\n    protected string $_code = 'customshipping';\n\n    protected bool $_isFixed = true;\n\n    private ResultFactory $rateResultFactory;\n\n    private MethodFactory $rateMethodFactory;\n\n    public function __construct(\n        ScopeConfigInterface $scopeConfig,\n        ErrorFactory $rateErrorFactory,\n        LoggerInterface $logger,\n        ResultFactory $rateResultFactory,\n        MethodFactory $rateMethodFactory,\n        array $data = []\n    ) {\n        parent::__construct($scopeConfig, $rateErrorFactory, $logger, $data);\n\n        $this->rateResultFactory = $rateResultFactory;\n        $this->rateMethodFactory = $rateMethodFactory;\n    }\n\n    /**\n     * Custom Shipping Rates Collector\n     *\n     * @param RateRequest $request\n     * @return \\Magento\\Shipping\\Model\\Rate\\Result|bool\n     */\n    public function collectRates(RateRequest $request)\n    {\n        if (!$this->getConfigFlag('active')) {\n            return false;\n        }\n\n        /** @var Method $method */\n        $method = $this->rateMethodFactory->create();\n\n        $method->setCarrier($this->_code);\n        $method->setCarrierTitle($this->getConfigData('title'));\n\n        $method->setMethod($this->_code);\n        $method->setMethodTitle($this->getConfigData('name'));\n\n        $shippingCost = (float) $this->getConfigData('shipping_cost');\n        $method->setPrice($shippingCost);\n        $method->setCost($shippingCost);\n\n        /** @var Result $result */\n        $result = $this->rateResultFactory->create();\n        $result->append($method);\n\n        return $result;\n    }\n\n    public function getAllowedMethods(): array\n    {\n        return [$this->_code => $this->getConfigData('name')];\n    }\n}\n")),(0,r.mdx)("h2",{id:"step-4-enable-the-module"},"Step 4: Enable the module"),(0,r.mdx)("p",null,"Run the commands below to register ",(0,r.mdx)("inlineCode",{parentName:"p"},"Vendor_CustomShipping")," module:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"bin/magento module:enable Vendor_CustomShipping\n")),(0,r.mdx)("h2",{id:"screenshots"},"Screenshots"),(0,r.mdx)("p",null,"The backend settings for the custom shipping carrier appear as shown below."),(0,r.mdx)("p",null,(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"50.31250000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/5530d/checkout-add-custom-carrier-01.webp 320w","/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/0c8fb/checkout-add-custom-carrier-01.webp 640w","/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/94b1e/checkout-add-custom-carrier-01.webp 1280w","/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/0b34d/checkout-add-custom-carrier-01.webp 1920w","/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/d5269/checkout-add-custom-carrier-01.webp 2560w","/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/a5b37/checkout-add-custom-carrier-01.webp 3320w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/dd4a7/checkout-add-custom-carrier-01.png 320w","/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/0f09e/checkout-add-custom-carrier-01.png 640w","/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/bbbf7/checkout-add-custom-carrier-01.png 1280w","/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/ac7a9/checkout-add-custom-carrier-01.png 1920w","/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/c7a69/checkout-add-custom-carrier-01.png 2560w","/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/353b7/checkout-add-custom-carrier-01.png 3320w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-php/static/440961b90934efa9da4a324a4e04e7ff/bbbf7/checkout-add-custom-carrier-01.png",alt:"Custom shipping carrier backend settings",title:"Custom shipping carrier backend settings",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,r.mdx)("p",null,"The custom shipping carrier will appear on checkout as shown below."),(0,r.mdx)("p",null,(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"60.62500000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/5530d/checkout-add-custom-carrier-02.webp 320w","/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/0c8fb/checkout-add-custom-carrier-02.webp 640w","/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/94b1e/checkout-add-custom-carrier-02.webp 1280w","/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/0b34d/checkout-add-custom-carrier-02.webp 1920w","/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/fca01/checkout-add-custom-carrier-02.webp 2044w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/dd4a7/checkout-add-custom-carrier-02.png 320w","/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/0f09e/checkout-add-custom-carrier-02.png 640w","/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/bbbf7/checkout-add-custom-carrier-02.png 1280w","/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/ac7a9/checkout-add-custom-carrier-02.png 1920w","/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/d9f65/checkout-add-custom-carrier-02.png 2044w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-php/static/76d4db2e265e7b46d88dab672a7b4f24/bbbf7/checkout-add-custom-carrier-02.png",alt:"Custom shipping carrier on checkout",title:"Custom shipping carrier on checkout",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-tutorials-frontend-custom-checkout-add-shipping-carrier-md-d813c8496cab14029064.js.map