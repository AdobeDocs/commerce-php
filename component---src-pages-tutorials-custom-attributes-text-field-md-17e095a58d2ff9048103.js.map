{"version":3,"file":"component---src-pages-tutorials-custom-attributes-text-field-md-17e095a58d2ff9048103.js","mappings":"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","sources":["webpack://commerce-php/./src/pages/tutorials/custom-attributes/text-field.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/commerce-php/commerce-php/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"add-a-custom-text-field-attribute\"\n    }}>{`Add a custom text field attribute`}</h1>\n    <p>{`This tutorial describes how a developer can create a custom text field attribute for the Customer entity using code. This will reflect in both the `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.magento.com/user-guide/customers/customer-account-manage.html\"\n      }}>{`Customer Grid`}</a>{` and the `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.magento.com/user-guide/customers/customer-account-update.html\"\n      }}>{`Customer Form`}</a>{` in the Admin.`}</p>\n    <p>{`This Customer attribute will be used to save and view the customer's ID in an external system, as an example. It will be created as an EAV attribute in a data patch. The EAV model allows a developer to add custom functionality to the entities without modifying the core databases and schemas. Data patches are run just once, so this code will create the custom attribute and will never run again, which could cause issues.`}</p>\n    <h2 {...{\n      \"id\": \"code\"\n    }}>{`Code`}</h2>\n    <h3 {...{\n      \"id\": \"create-the-data-patch-class\"\n    }}>{`Create the data patch class`}</h3>\n    <p>{`Create a data patch class called `}<inlineCode parentName=\"p\">{`ExternalId`}</inlineCode>{` under the `}<inlineCode parentName=\"p\">{`\\\\ExampleCorp\\\\Customer\\\\Setup\\\\Patch\\\\Data`}</inlineCode>{` namespace. This makes the application execute the data patch automatically when `}<inlineCode parentName=\"p\">{`bin/magento setup:upgrade`}</inlineCode>{` is run. All data patches must implement the `}<inlineCode parentName=\"p\">{`\\\\Magento\\\\Framework\\\\Setup\\\\Patch\\\\DataPatchInterface`}</inlineCode>{` interface.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`<?php\n\nnamespace ExampleCorp\\\\Customer\\\\Setup\\\\Patch\\\\Data;\n\nuse \\\\Magento\\\\Framework\\\\Setup\\\\Patch\\\\DataPatchInterface;\n\nclass ExternalId implements DataPatchInterface\n{\n    public function apply()\n    {\n        // will be implemented in the next steps.\n    }\n\n    public function getAliases()\n    {\n        // will be implemented in the next steps.\n    }\n\n    public function getDependencies()\n    {\n        // will be implemented in the next steps.\n    }\n}\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"inject-the-dependencies\"\n    }}>{`Inject the dependencies`}</h3>\n    <p>{`The dependencies to the data patch are injected using constructor DI and are listed below:`}</p>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`\\\\Magento\\\\Framework\\\\Setup\\\\ModuleDataSetupInterface`}</inlineCode>{` for initializing and ending the setup.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`\\\\Magento\\\\Customer\\\\Setup\\\\CustomerSetupFactory`}</inlineCode>{` for creating a model of `}<inlineCode parentName=\"p\">{`\\\\Magento\\\\Customer\\\\Setup\\\\CustomerSetup`}</inlineCode>{` which is required to add the custom attribute.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`\\\\Magento\\\\Customer\\\\Model\\\\ResourceModel\\\\Attribute`}</inlineCode>{` aliased as `}<inlineCode parentName=\"p\">{`AttributeResource`}</inlineCode>{` for saving the attribute after adding custom data to it.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`\\\\Psr\\\\Log\\\\LoggerInterface`}</inlineCode>{` for logging exceptions thrown during the execution.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-php\"\n          }}>{`/**\n * Constructor\n *\n * @param ModuleDataSetupInterface $moduleDataSetup\n * @param CustomerSetupFactory $customerSetupFactory\n * @param AttributeResource $attributeResource\n * @param LoggerInterface $logger\n */\npublic function __construct(\n    ModuleDataSetupInterface $moduleDataSetup,\n    CustomerSetupFactory $customerSetupFactory,\n    AttributeResource $attributeResource,\n    LoggerInterface $logger\n) {\n    $this->moduleDataSetup = $moduleDataSetup;\n    $this->customerSetup = $customerSetupFactory->create(['setup' => $moduleDataSetup]);\n    $this->attributeResource = $attributeResource;\n    $this->logger = $logger;\n}\n`}</code></pre>\n      </li>\n    </ul>\n    <h3 {...{\n      \"id\": \"implement-the-apply-method\"\n    }}>{`Implement the apply method`}</h3>\n    <p>{`There are five steps in developing a data patch. All the steps below are written inside the `}<inlineCode parentName=\"p\">{`apply`}</inlineCode>{` method.`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Starting and ending the setup execution. This turns off foreign key checks and sets the SQL mode.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-php\"\n          }}>{`$this->moduleDataSetup->getConnection()->startSetup();\n\n/*\n  Attribute creation code must be run between these two lines\n  to ensure that the attribute is created smoothly.\n */\n\n$this->moduleDataSetup->getConnection()->endSetup();\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Add the text field customer attribute with the required settings.`}</p>\n        <p parentName=\"li\">{`The third parameter for `}<inlineCode parentName=\"p\">{`addAttribute`}</inlineCode>{` is an array of settings required to configure the attribute. Passing an empty array uses all the default values for each possible setting. To keep the code to a minimum, just declare the settings needing to be overridden and the rest of the settings will be used from the defaults. The settings overrides can be done as described below.`}</p>\n        <p parentName=\"li\">{`For creating a simple text field, it is not necessary to override the settings for `}<inlineCode parentName=\"p\">{`backend`}</inlineCode>{` (database field type) and `}<inlineCode parentName=\"p\">{`input`}</inlineCode>{` (frontend HTML input type), as they default to `}<inlineCode parentName=\"p\">{`varchar`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`text`}</inlineCode>{` respectively.`}</p>\n        <p parentName=\"li\">{`The `}<inlineCode parentName=\"p\">{`\\\\Magento\\\\Customer\\\\Api\\\\CustomerMetadataInterface`}</inlineCode>{` interface contains constants like the customer entity's code and the default attribute set code, which can be referenced.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-php\"\n          }}>{`$this->customerSetup->addAttribute(\n    CustomerMetadataInterface::ENTITY_TYPE_CUSTOMER, // entity type code\n    'externalcorp_external_id', // unique attribute code\n    [\n        'label' => 'External ID',\n        'required' => 0,\n        'position' => 200,\n        'system' => 0,\n        'user_defined' => 1,\n        'is_used_in_grid' => 1,\n        'is_visible_in_grid' => 1,\n        'is_filterable_in_grid' => 1,\n        'is_searchable_in_grid' => 1,\n    ]\n);\n`}</code></pre>\n        <table parentName=\"li\">\n          <thead parentName=\"table\">\n            <tr parentName=\"thead\">\n              <th parentName=\"tr\" {...{\n                \"align\": null\n              }}>{`Setting Key`}</th>\n              <th parentName=\"tr\" {...{\n                \"align\": null\n              }}>{`Description`}</th>\n            </tr>\n          </thead>\n          <tbody parentName=\"table\">\n            <tr parentName=\"tbody\">\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`label`}</inlineCode></td>\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`External ID`}</inlineCode>{` - Label for displaying the attribute value`}</td>\n            </tr>\n            <tr parentName=\"tbody\">\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`required`}</inlineCode></td>\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`0`}</inlineCode>{` - Attribute will be an optional field in the customer form`}</td>\n            </tr>\n            <tr parentName=\"tbody\">\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`position`}</inlineCode></td>\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`200`}</inlineCode>{` - Sort order in the customer form`}</td>\n            </tr>\n            <tr parentName=\"tbody\">\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`system`}</inlineCode></td>\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`0`}</inlineCode>{` - Not a system-defined attribute`}</td>\n            </tr>\n            <tr parentName=\"tbody\">\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`user_defined`}</inlineCode></td>\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`1`}</inlineCode>{` - A user-defined attribute`}</td>\n            </tr>\n            <tr parentName=\"tbody\">\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`is_used_in_grid`}</inlineCode></td>\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`1`}</inlineCode>{` - Ready for use in the customer grid`}</td>\n            </tr>\n            <tr parentName=\"tbody\">\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`is_visible_in_grid`}</inlineCode></td>\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`1`}</inlineCode>{` - Visible in the customer grid`}</td>\n            </tr>\n            <tr parentName=\"tbody\">\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`is_filterable_in_grid`}</inlineCode></td>\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`1`}</inlineCode>{` - Filterable in the customer grid`}</td>\n            </tr>\n            <tr parentName=\"tbody\">\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`is_searchable_in_grid`}</inlineCode></td>\n              <td parentName=\"tr\" {...{\n                \"align\": null\n              }}><inlineCode parentName=\"td\">{`1`}</inlineCode>{` - Searchable in the customer grid`}</td>\n            </tr>\n          </tbody>\n        </table>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Add attribute to an attribute set and group.`}</p>\n        <p parentName=\"li\">{`There is only one attribute set and group for the customer entity. The default attribute set ID is a constant defined the `}<inlineCode parentName=\"p\">{`CustomerMetadataInterface`}</inlineCode>{` interface and setting the attribute group ID to null makes the application use the default attribute group ID for the customer entity.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-php\"\n          }}>{`$this->customerSetup->addAttributeToSet(\n    CustomerMetadataInterface::ENTITY_TYPE_CUSTOMER, // entity type code\n    CustomerMetadataInterface::ATTRIBUTE_SET_ID_CUSTOMER, // attribute set ID\n    null, // attribute group ID\n    'externalcorp_external_id' // unique attribute code\n);\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Make the attribute visible in the customer form.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-php\"\n          }}>{`// Get the newly created attribute's model\n$attribute = $this->customerSetup->getEavConfig()\n    ->getAttribute(CustomerMetadataInterface::ENTITY_TYPE_CUSTOMER, 'externalcorp_external_id');\n\n// Make attribute visible in Admin customer form\n$attribute->setData('used_in_forms', [\n    'adminhtml_customer'\n]);\n\n// Save modified attribute model using its resource model\n$this->attributeResource->save($attribute);\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Gracefully handle exceptions.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-php\"\n          }}>{`try {\n    // All the code inside the apply method goes into the try block.\n} catch (Exception $exception) {\n    $this->logger->err($exception->getMessage());\n}\n`}</code></pre>\n      </li>\n    </ol>\n    <h3 {...{\n      \"id\": \"implement-rest-of-the-interface\"\n    }}>{`Implement rest of the interface`}</h3>\n    <p>{`This data patch does not have any other patch as a dependency, and this data patch was not renamed earlier, so both `}<inlineCode parentName=\"p\">{`getDependencies`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`getAliases`}</inlineCode>{` can return an empty array.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`public static function getDependencies(): array\n{\n    return [];\n}\n\npublic function getAliases(): array\n{\n    return [];\n}\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"execute-the-data-patch\"\n    }}>{`Execute the data patch`}</h3>\n    <p>{`Run `}<inlineCode parentName=\"p\">{`bin/magento setup:upgrade`}</inlineCode>{` from the project root to execute the newly added data patch.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`The attribute is created in the customer form under the `}<em parentName=\"li\">{`Account Information`}</em>{` section.`}</li>\n    </ul>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"880px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"14.0625%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-php/static/dd83348fd135fecb133a991b7ca3033e/cb523/customer-text-form.webp 320w\", \"/commerce-php/static/dd83348fd135fecb133a991b7ca3033e/797b9/customer-text-form.webp 640w\", \"/commerce-php/static/dd83348fd135fecb133a991b7ca3033e/f2da9/customer-text-form.webp 880w\"],\n            \"sizes\": \"(max-width: 880px) 100vw, 880px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-php/static/dd83348fd135fecb133a991b7ca3033e/72799/customer-text-form.png 320w\", \"/commerce-php/static/dd83348fd135fecb133a991b7ca3033e/6af66/customer-text-form.png 640w\", \"/commerce-php/static/dd83348fd135fecb133a991b7ca3033e/9c177/customer-text-form.png 880w\"],\n            \"sizes\": \"(max-width: 880px) 100vw, 880px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/commerce-php/static/dd83348fd135fecb133a991b7ca3033e/9c177/customer-text-form.png\",\n            \"alt\": \"Custom attribute in the customer form\",\n            \"title\": \"Custom attribute in the customer form\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <ul>\n      <li parentName=\"ul\">{`The attribute is displayed in the customer grid.`}</li>\n    </ul>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"880px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"12.5%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-php/static/a868b7943757992c9d5af2ba3eced04e/cb523/customer-text-grid.webp 320w\", \"/commerce-php/static/a868b7943757992c9d5af2ba3eced04e/797b9/customer-text-grid.webp 640w\", \"/commerce-php/static/a868b7943757992c9d5af2ba3eced04e/f2da9/customer-text-grid.webp 880w\"],\n            \"sizes\": \"(max-width: 880px) 100vw, 880px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/commerce-php/static/a868b7943757992c9d5af2ba3eced04e/72799/customer-text-grid.png 320w\", \"/commerce-php/static/a868b7943757992c9d5af2ba3eced04e/6af66/customer-text-grid.png 640w\", \"/commerce-php/static/a868b7943757992c9d5af2ba3eced04e/9c177/customer-text-grid.png 880w\"],\n            \"sizes\": \"(max-width: 880px) 100vw, 880px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/commerce-php/static/a868b7943757992c9d5af2ba3eced04e/9c177/customer-text-grid.png\",\n            \"alt\": \"Custom attribute in the customer grid\",\n            \"title\": \"Custom attribute in the customer grid\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <h3 {...{\n      \"id\": \"code-reference\"\n    }}>{`Code reference`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php\"\n      }}>{`<?php declare(strict_types=1);\n\nnamespace ExampleCorp\\\\Customer\\\\Setup\\\\Patch\\\\Data;\n\nuse Exception;\nuse Psr\\\\Log\\\\LoggerInterface;\nuse Magento\\\\Customer\\\\Api\\\\CustomerMetadataInterface;\nuse Magento\\\\Customer\\\\Model\\\\ResourceModel\\\\Attribute as AttributeResource;\nuse Magento\\\\Customer\\\\Setup\\\\CustomerSetup;\nuse Magento\\\\Customer\\\\Setup\\\\CustomerSetupFactory;\nuse Magento\\\\Framework\\\\Setup\\\\ModuleDataSetupInterface;\nuse Magento\\\\Framework\\\\Setup\\\\Patch\\\\DataPatchInterface;\n\n/**\n * Creates a customer attribute for managing a customer's external system ID\n */\nclass ExternalId implements DataPatchInterface\n{\n    /**\n     * @var ModuleDataSetupInterface\n     */\n    private $moduleDataSetup;\n\n    /**\n     * @var CustomerSetup\n     */\n    private $customerSetup;\n\n    /**\n     * @var AttributeResource\n     */\n    private $attributeResource;\n\n    /**\n     * @var LoggerInterface\n     */\n    private $logger;\n\n    /**\n     * Constructor\n     *\n     * @param ModuleDataSetupInterface $moduleDataSetup\n     * @param CustomerSetupFactory $customerSetupFactory\n     * @param AttributeResource $attributeResource\n     * @param LoggerInterface $logger\n     */\n    public function __construct(\n        ModuleDataSetupInterface $moduleDataSetup,\n        CustomerSetupFactory $customerSetupFactory,\n        AttributeResource $attributeResource,\n        LoggerInterface $logger\n    ) {\n        $this->moduleDataSetup = $moduleDataSetup;\n        $this->customerSetup = $customerSetupFactory->create(['setup' => $moduleDataSetup]);\n        $this->attributeResource = $attributeResource;\n        $this->logger = $logger;\n    }\n\n    /**\n     * Get array of patches that have to be executed prior to this.\n     *\n     * Example of implementation:\n     *\n     * [\n     *      \\\\Vendor_Name\\\\Module_Name\\\\Setup\\\\Patch\\\\Patch1::class,\n     *      \\\\Vendor_Name\\\\Module_Name\\\\Setup\\\\Patch\\\\Patch2::class\n     * ]\n     *\n     * @return string[]\n     */\n    public static function getDependencies(): array\n    {\n        return [];\n    }\n\n    /**\n     * Get aliases (previous names) for the patch.\n     *\n     * @return string[]\n     */\n    public function getAliases(): array\n    {\n        return [];\n    }\n\n    /**\n     * Run code inside patch\n     */\n    public function apply()\n    {\n        // Start setup\n        $this->moduleDataSetup->getConnection()->startSetup();\n\n        try {\n            // Add customer attribute with settings\n            $this->customerSetup->addAttribute(\n                CustomerMetadataInterface::ENTITY_TYPE_CUSTOMER,\n                'externalcorp_external_id',\n                [\n                    'label' => 'External ID',\n                    'required' => 0,\n                    'position' => 100,\n                    'system' => 0,\n                    'user_defined' => 1,\n                    'is_used_in_grid' => 1,\n                    'is_visible_in_grid' => 1,\n                    'is_filterable_in_grid' => 1,\n                    'is_searchable_in_grid' => 1,\n                ]\n            );\n\n            // Add attribute to default attribute set and group\n            $this->customerSetup->addAttributeToSet(\n                CustomerMetadataInterface::ENTITY_TYPE_CUSTOMER,\n                CustomerMetadataInterface::ATTRIBUTE_SET_ID_CUSTOMER,\n                null,\n                'externalcorp_external_id'\n            );\n\n            // Get the newly created attribute's model\n            $attribute = $this->customerSetup->getEavConfig()\n                ->getAttribute(CustomerMetadataInterface::ENTITY_TYPE_CUSTOMER, 'externalcorp_external_id');\n\n            // Make attribute visible in Admin customer form\n            $attribute->setData('used_in_forms', [\n                'adminhtml_customer'\n            ]);\n\n            // Save attribute using its resource model\n            $this->attributeResource->save($attribute);\n        } catch (Exception $e) {\n            $this->logger->err($e->getMessage());\n        }\n\n        // End setup\n        $this->moduleDataSetup->getConnection()->endSetup();\n    }\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"sourceRoot":""}